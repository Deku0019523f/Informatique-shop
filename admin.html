<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Admin - Informatique Shop</title>
  <style>
    body { font-family: Arial; background: #f0f0f0; padding: 20px; }
    .panel, .login-form { max-width: 400px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
    input, select, button { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>

<div class="login-form">
  <h2>Connexion Admin</h2>
  <input type="email" id="email" placeholder="Email admin">
  <input type="password" id="password" placeholder="Mot de passe">
  <button onclick="login()">Se connecter</button>
</div>

<div class="panel" id="admin-panel" style="display:none;">
  <h2>Ajouter un produit</h2>
  <input type="text" id="title" placeholder="Nom du produit">
  <input type="number" id="price" placeholder="Prix en FCFA">
  <select id="category">
    <option value="FREE">FREE</option>
    <option value="Abonnement">Abonnement</option>
    <option value="Logiciel">Logiciel</option>
  </select>
  <input type="text" id="image" placeholder="URL image (ex: images/nom.jpg)">
  <button onclick="addProduct()">Ajouter</button>
  <p id="status"></p>
</div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC2EZx8g3HPjfIC5ELQKdwofNifn3xCgbo",
    authDomain: "informatique-shop-53a25.firebaseapp.com",
    projectId: "informatique-shop-53a25",
    storageBucket: "informatique-shop-53a25.firebasestorage.app",
    messagingSenderId: "1070472171156",
    appId: "1:1070472171156:web:6214bbe7726c12ce666e81",
    measurementId: "G-WCQCBR1CNR"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore();

  window.login = function () {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    signInWithEmailAndPassword(auth, email, password)
      .then(() => {
        alert("Connexion réussie !");
        document.querySelector(".login-form").style.display = "none";
        document.getElementById("admin-panel").style.display = "block";
      })
      .catch(error => alert("Erreur de connexion : " + error.message));
  };

  window.addProduct = async function () {
    const title = document.getElementById("title").value.trim();
    const price = parseInt(document.getElementById("price").value);
    const category = document.getElementById("category").value;
    const img = document.getElementById("image").value.trim();

    if (!title || isNaN(price) || !category || !img) {
      alert("Tous les champs sont obligatoires.");
      return;
    }

    try {
      await addDoc(collection(db, "products"), { title, price, category, img });
      alert("Produit ajouté !");
      document.getElementById("status").textContent = "Produit ajouté avec succès !";
    } catch (e) {
      alert("Erreur Firebase : " + e.message);
      document.getElementById("status").textContent = "Erreur lors de l'ajout.";
    }
  };
</script>

</body>
</html>
